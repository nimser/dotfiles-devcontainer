#!/bin/bash

set -euo pipefail

# Install pkgx 
if ! command -v pkgx > /dev/null; then
  curl -fsS https://pkgx.sh | sh
fi

# Install and initialize chezmoi in one go
if ! command -v chezmoi > /dev/null; then
  sh -c "$(curl -fsLS get.chezmoi.io)" -- init --apply git@github.com:nimser/private-dotfiles-devcontainer.git
fi


# Set up XDG_CONFIG_HOME
export XDG_CONFIG_HOME="$HOME"/.config
mkdir -p "$XDG_CONFIG_HOME"
mkdir -p "$HOME"/.local/share

# Create symlinks
ln -sf "$PWD/nvim" "$XDG_CONFIG_HOME"/nvim
ln -sf "$PWD/fish" "$XDG_CONFIG_HOME"/fish
ln -sf "$PWD/tealdeer" "$XDG_CONFIG_HOME"/tealdeer
ln -sf "$PWD/ripgrep" "$XDG_CONFIG_HOME"/ripgrep
ln -sf "$PWD/fd" "$XDG_CONFIG_HOME"/fd
ln -sf "$PWD/fonts" "$HOME"/.local/share/fonts

ln -sf "$PWD/rclone/rclone" "$HOME"/.local/bin/rclone
exit 0
